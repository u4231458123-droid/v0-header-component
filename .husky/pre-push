#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# =============================================================================
# MyDispatch - Pre-Push Hook
# =============================================================================
# Basierend auf CPO-Vorgaben
# =============================================================================

echo "üîç Pre-Push Validierung..."
echo -e "==========================\n"

# =============================================================================
# PHASE 1: BUILD TEST
# =============================================================================

echo "üèóÔ∏è Phase 1: Build Test..."
npm run build || {
  echo -e "\n‚ùå Build fehlgeschlagen - Push abgebrochen"
  exit 1
}

# =============================================================================
# PHASE 2: ABH√ÑNGIGKEITS-PR√úFUNG
# =============================================================================

echo -e "\nüîó Phase 2: Abh√§ngigkeits-Pr√ºfung..."
if [ -f "scripts/cicd/check-dependencies.mjs" ]; then
  node scripts/cicd/check-dependencies.mjs || {
    echo -e "\n‚ö†Ô∏è Abh√§ngigkeits-Pr√ºfung hat Warnungen gefunden (nicht blockierend)"
  }
else
  echo "‚ö†Ô∏è Abh√§ngigkeits-Pr√ºfungs-Script nicht gefunden - √ºberspringe"
fi

echo -e "\n‚úÖ Pre-Push Validierung erfolgreich!"
